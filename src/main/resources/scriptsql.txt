CREATE TABLE IF NOT EXISTS user (
    user_id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    email VARCHAR,
    login VARCHAR,
    name VARCHAR,
    birth DATE
);

CREATE TABLE IF NOT EXISTS mpa_rating (
    mpa_rating_id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    name VARCHAR
);

CREATE TABLE IF NOT EXISTS film (
    film_id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    name VARCHAR,
    description VARCHAR,
    release_date DATE,
    duration INTEGER,
    mpa_rating_id INTEGER REFERENCES mpa_rating (mpa_rating_id)
);


CREATE TABLE IF NOT EXISTS genre (
    genre_id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    name VARCHAR
);

CREATE TABLE IF NOT EXISTS film_genre (
    film_id REFERENCES film (film_id),
    genre_id REFERENCES genre (genre_id),
);

CREATE TABLE IF NOT EXISTS user_like (
    user_id REFERENCES user (user_id),
    film_id REFERENCES film (film_id),
);

CREATE TABLE IF NOT EXISTS user_friend (
    user_id REFERENCES user (user_id),
    user_friend_id REFERENCES user (user_id)
);


**************
CREATE TABLE IF NOT EXISTS PUBLIC.USER (); ???
ALTER TABLE PUBLIC.USER ADD USER_ID INTEGER NOT NULL AUTO_INCREMENT;
ALTER TABLE PUBLIC.USER ADD EMAIL CHARACTER VARYING NOT NULL;
ALTER TABLE PUBLIC.USER ADD LOGIN CHARACTER VARYING NOT NULL;
ALTER TABLE PUBLIC.USER ADD NAME CHARACTER VARYING;
ALTER TABLE PUBLIC.USER ADD BIRTH DATE;
ALTER TABLE PUBLIC.USER ADD CONSTRAINT USER_PK PRIMARY KEY (USER_ID);

CREATE TABLE IF NOT EXISTS PUBLIC.USER (
	USER_ID INTEGER NOT NULL AUTO_INCREMENT,
	EMAIL CHARACTER VARYING NOT NULL,
	LOGIN CHARACTER VARYING NOT NULL,
	NAME CHARACTER VARYING,
	BIRTH DATE
);
************
CREATE TABLE IF NOT EXISTS PUBLIC.MPA_RATING (
	MPA_RATING_ID INTEGER AUTO_INCREMENT,
	NAME CHARACTER VARYING,
	CONSTRAINT MPA_RATING_PK PRIMARY KEY (MPA_RATING_ID)
);
**********
CREATE TABLE IF NOT EXISTS PUBLIC.FILM (
	FILM_ID INTEGER NOT NULL AUTO_INCREMENT,
	NAME CHARACTER VARYING NOT NULL,
	DESCRIPTION CHARACTER VARYING,
	RELEASE_DATE DATE,
	DURATION INTEGER,
	MPA_RATING_ID INTEGER,
	CONSTRAINT FILM_PK PRIMARY KEY (FILM_ID),
	CONSTRAINT FILM_FK FOREIGN KEY (MPA_RATING_ID) REFERENCES PUBLIC.MPA_RATING(MPA_RATING_ID)
);
???
CREATE TABLE IF NOT EXISTS PUBLIC.FILM (
	FILM_ID INTEGER NOT NULL AUTO_INCREMENT,
	NAME CHARACTER VARYING NOT NULL,
	DESCRIPTION CHARACTER VARYING,
	RELEASE_DATE DATE,
	DURATION INTEGER,
	MPA_RATING_ID INTEGER,
	CONSTRAINT FILM_FK PRIMARY KEY (MPA_RATING_ID,MPA_RATING_ID),
	CONSTRAINT FILM_PK PRIMARY KEY (FILM_ID),
	CONSTRAINT FILM_FK FOREIGN KEY (MPA_RATING_ID) REFERENCES PUBLIC.MPA_RATING(MPA_RATING_ID) ON DELETE RESTRICT ON UPDATE RESTRICT
);
CREATE INDEX IF NOT EXISTS FILM_FK_INDEX_2 ON PUBLIC.FILM (MPA_RATING_ID);
CREATE UNIQUE INDEX IF NOT EXISTS PRIMARY_KEY_2 ON PUBLIC.FILM (FILM_ID);
************
CREATE TABLE IF NOT EXISTS PUBLIC.GENRE (
	GENRE_ID INTEGER NOT NULL AUTO_INCREMENT,
	NAME CHARACTER VARYING,
	CONSTRAINT GENRE_PK PRIMARY KEY (GENRE_ID)
);
CREATE UNIQUE INDEX IF NOT EXISTS PRIMARY_KEY_B ON PUBLIC.GENRE (GENRE_ID);
************
CREATE TABLE IF NOT EXISTS PUBLIC.FILM_GENRE (
	FILM_ID INTEGER,
	GENRE_ID INTEGER,
	CONSTRAINT FILM_GENRE_FK PRIMARY KEY (GENRE_ID,GENRE_ID),
	CONSTRAINT FILM_GENRE_FK1 PRIMARY KEY (FILM_ID,FILM_ID),
	CONSTRAINT FILM_GENRE_FK FOREIGN KEY (GENRE_ID) REFERENCES PUBLIC.GENRE(GENRE_ID) ON DELETE RESTRICT ON UPDATE RESTRICT,
	CONSTRAINT FILM_GENRE_FK1 FOREIGN KEY (FILM_ID) REFERENCES PUBLIC.FILM(FILM_ID) ON DELETE RESTRICT ON UPDATE RESTRICT
);
CREATE INDEX IF NOT EXISTS FILM_GENRE_FK1_INDEX_7 ON PUBLIC.FILM_GENRE (FILM_ID);
CREATE INDEX IF NOT EXISTS FILM_GENRE_FK_INDEX_7 ON PUBLIC.FILM_GENRE (GENRE_ID);
***********
CREATE TABLE PUBLIC.USER_LIKE (
	USER_ID INTEGER,
	FILM_ID INTEGER,
	CONSTRAINT USER_LIKE_FK PRIMARY KEY (USER_ID,USER_ID),
	CONSTRAINT USER_LIKE_FK_1 PRIMARY KEY (FILM_ID,FILM_ID),
	CONSTRAINT USER_LIKE_FK FOREIGN KEY (USER_ID) REFERENCES PUBLIC."USER"(USER_ID) ON DELETE RESTRICT ON UPDATE RESTRICT,
	CONSTRAINT USER_LIKE_FK_1 FOREIGN KEY (FILM_ID) REFERENCES PUBLIC.FILM(FILM_ID) ON DELETE RESTRICT ON UPDATE RESTRICT
);
CREATE INDEX IF NOT EXISTS USER_LIKE_FK_1_INDEX_B ON PUBLIC.USER_LIKE (FILM_ID);
CREATE INDEX IF NOT EXISTS USER_LIKE_FK_INDEX_7 ON PUBLIC.USER_LIKE (USER_ID);

CREATE TABLE IF NOT EXISTS PUBLIC.USER_FRIEND (
	USER_ID INTEGER,
	USER_FRIEND_ID INTEGER,
	CONSTRAINT USER_FRIEND_FK PRIMARY KEY (USER_ID,USER_ID),
	CONSTRAINT USER_FRIEND_FK_1 PRIMARY KEY (USER_ID,USER_FRIEND_ID),
	CONSTRAINT USER_FRIEND_FK FOREIGN KEY (USER_ID) REFERENCES PUBLIC."USER"(USER_ID) ON DELETE RESTRICT ON UPDATE RESTRICT,
	CONSTRAINT USER_FRIEND_FK_1 FOREIGN KEY (USER_FRIEND_ID) REFERENCES PUBLIC."USER"(USER_ID) ON DELETE RESTRICT ON UPDATE RESTRICT
	??? CONSTRAINT USER_FRIEND_PK PRIMARY KEY (USER_ID,USER_FRIEND_ID)
);
CREATE INDEX IF NOT EXISTS USER_FRIEND_FK_1_INDEX_F ON PUBLIC.USER_FRIEND (USER_FRIEND_ID);
CREATE INDEX IF NOT EXISTS USER_FRIEND_FK_INDEX_F ON PUBLIC.USER_FRIEND (USER_ID);

***************
**************
**********
INSERT INTO PUBLIC."USER" (user_id, email, login, name, birth) values
( 1, '12345@mail.ru', '11111', 'name', '2010-09-07' );
INSERT INTO PUBLIC."USER" (user_id, email, login, name, birth) values
( 2, 'alex@mail.ru', 'leha', 'alexey', '2005-11-23' );
INSERT INTO PUBLIC."USER" (user_id, email, login, name, birth) values
( 3, 'kate@ya.ru', 'katty', 'katya', '1995-08-17' );
INSERT INTO PUBLIC."USER" (user_id, email, login, name, birth) values
( 4, 'pro@mail.ru', 'prof', 'pro', '1998-02-14' );
INSERT INTO PUBLIC."USER" (user_id, email, login, name, birth) values
( 5, 'lena@google.com', 'lenok', 'elena', '1983-12-28' );
************
INSERT INTO PUBLIC."MPA_RATING" (mpa_rating_id, name) values ( 1, 'G');
INSERT INTO PUBLIC."MPA_RATING" (mpa_rating_id, name) values ( 2, 'PG');
INSERT INTO PUBLIC."MPA_RATING" (mpa_rating_id, name) values ( 3, 'PG-13');
INSERT INTO PUBLIC."MPA_RATING" (mpa_rating_id, name) values ( 4, 'R');
INSERT INTO PUBLIC."MPA_RATING" (mpa_rating_id, name) values ( 5, 'NC-17');
*************
INSERT INTO PUBLIC."FILM" (film_id, name, description, release_date, duration, mpa_rating_id) values
( 1, 'Alexandr', 'History', '2000-09-07', 98, 3 );
INSERT INTO PUBLIC."FILM" (film_id, name, description, release_date, duration, mpa_rating_id) values
( 2, 'Bambuk', 'Wild Life', '1982-05-03', 58, 4 );
INSERT INTO PUBLIC."FILM" (film_id, name, description, release_date, duration, mpa_rating_id) values
( 3, 'Caesar', 'History', '1953-10-20', 128, 2 );
INSERT INTO PUBLIC."FILM" (film_id, name, description, release_date, duration, mpa_rating_id) values
( 4, 'Menty', 'Life', '1995-04-04', 48, 3 );
INSERT INTO PUBLIC."FILM" (film_id, name, description, release_date, duration, mpa_rating_id) values
( 5, 'Lorry', 'Melodrama', '1967-03-24', 103, 5 );
******************
INSERT INTO PUBLIC."GENRE" (genre_id, name) values ( 1, 'COMEDY');
INSERT INTO PUBLIC."GENRE" (genre_id, name) values ( 2, 'DRAMA');
INSERT INTO PUBLIC."GENRE" (genre_id, name) values ( 3, 'CARTOON');
INSERT INTO PUBLIC."GENRE" (genre_id, name) values ( 4, 'THRILLER');
INSERT INTO PUBLIC."GENRE" (genre_id, name) values ( 5, 'DOCUMENTARY');
INSERT INTO PUBLIC."GENRE" (genre_id, name) values ( 6, 'ACTION');
*****************
INSERT INTO PUBLIC."FILM_GENRE" (film_id, genre_id) values ( 1, 2);
INSERT INTO PUBLIC."FILM_GENRE" (film_id, genre_id) values ( 1, 6);
INSERT INTO PUBLIC."FILM_GENRE" (film_id, genre_id) values ( 2, 1);
INSERT INTO PUBLIC."FILM_GENRE" (film_id, genre_id) values ( 3, 3);
INSERT INTO PUBLIC."FILM_GENRE" (film_id, genre_id) values ( 3, 5);
INSERT INTO PUBLIC."FILM_GENRE" (film_id, genre_id) values ( 4, 2);
INSERT INTO PUBLIC."FILM_GENRE" (film_id, genre_id) values ( 5, 4);
INSERT INTO PUBLIC."FILM_GENRE" (film_id, genre_id) values ( 5, 2);
******************
INSERT INTO PUBLIC."USER_LIKE" (user_id, film_id) values ( 1, 2);
INSERT INTO PUBLIC."USER_LIKE" (user_id, film_id) values ( 1, 4);
INSERT INTO PUBLIC."USER_LIKE" (user_id, film_id) values ( 3, 2);
INSERT INTO PUBLIC."USER_LIKE" (user_id, film_id) values ( 4, 5);
INSERT INTO PUBLIC."USER_LIKE" (user_id, film_id) values ( 5, 1);
INSERT INTO PUBLIC."USER_LIKE" (user_id, film_id) values ( 5, 2);
****************
INSERT INTO PUBLIC."USER_FRIEND" (user_id, user_friend_id) values ( 1, 2);
INSERT INTO PUBLIC."USER_FRIEND" (user_id, user_friend_id) values ( 2, 1);
INSERT INTO PUBLIC."USER_FRIEND" (user_id, user_friend_id) values ( 1, 3);
INSERT INTO PUBLIC."USER_FRIEND" (user_id, user_friend_id) values ( 3, 1);
INSERT INTO PUBLIC."USER_FRIEND" (user_id, user_friend_id) values ( 2, 4);
INSERT INTO PUBLIC."USER_FRIEND" (user_id, user_friend_id) values ( 2, 5);
INSERT INTO PUBLIC."USER_FRIEND" (user_id, user_friend_id) values ( 1, 4);
INSERT INTO PUBLIC."USER_FRIEND" (user_id, user_friend_id) values ( 4, 3);



--delete from user_friend;
--delete from user_like;
--delete from "USER";
--delete from film_genre;
--delete from genre;
--delete from film;
--delete from mpa_rating;

insert INTO PUBLIC."USER" (user_id, email, login, name, birth) values
( 1, '12345@mail.ru', '11111', 'name', '2010-09-07' );
insert INTO PUBLIC."USER" (user_id, email, login, name, birth) values
( 2, 'alex@mail.ru', 'leha', 'alexey', '2005-11-23' );
insert INTO PUBLIC."USER" (user_id, email, login, name, birth) values
( 3, 'kate@ya.ru', 'katty', 'katya', '1995-08-17' );
insert INTO PUBLIC."USER" (user_id, email, login, name, birth) values
( 4, 'pro@mail.ru', 'prof', 'pro', '1998-02-14' );
insert INTO PUBLIC."USER" (user_id, email, login, name, birth) values
( 5, 'lena@google.com', 'lenok', 'elena', '1983-12-28' );
insert INTO PUBLIC."USER" (user_id, email, login, name, birth) values
( 6, 'anny@mail.ru', 'ann', 'anna', '2000-10-02' );

insert INTO PUBLIC."MPA_RATING" (mpa_rating_id, name) values ( 1, 'G');
insert INTO PUBLIC."MPA_RATING" (mpa_rating_id, name) values ( 2, 'PG');
insert INTO PUBLIC."MPA_RATING" (mpa_rating_id, name) values ( 3, 'PG-13');
insert INTO PUBLIC."MPA_RATING" (mpa_rating_id, name) values ( 4, 'R');
insert INTO PUBLIC."MPA_RATING" (mpa_rating_id, name) values ( 5, 'NC-17');

insert INTO PUBLIC."FILM" (film_id, name, description, release_date, duration, mpa_rating_id) values
( 1, 'Alexandr', 'History', '2000-09-07', 98, 3 );
insert INTO PUBLIC."FILM" (film_id, name, description, release_date, duration, mpa_rating_id) values
( 2, 'Bambuk', 'Wild Life', '1982-05-03', 58, 4 );
insert INTO PUBLIC."FILM" (film_id, name, description, release_date, duration, mpa_rating_id) values
( 3, 'Caesar', 'History', '1953-10-20', 128, 2 );
insert INTO PUBLIC."FILM" (film_id, name, description, release_date, duration, mpa_rating_id) values
( 4, 'Menty', 'Life', '1995-04-04', 48, 3 );
insert INTO PUBLIC."FILM" (film_id, name, description, release_date, duration, mpa_rating_id) values
( 5, 'Lorry', 'Melodrama', '1967-03-24', 103, 5 );
insert INTO PUBLIC."FILM" (film_id, name, description, release_date, duration, mpa_rating_id) values
( 6, 'Mango', 'Something strange', '1982-06-20', 91, 3 );

insert INTO PUBLIC."GENRE" (genre_id, name) values ( 1, 'COMEDY');
insert INTO PUBLIC."GENRE" (genre_id, name) values ( 2, 'DRAMA');
insert INTO PUBLIC."GENRE" (genre_id, name) values ( 3, 'CARTOON');
insert INTO PUBLIC."GENRE" (genre_id, name) values ( 4, 'THRILLER');
insert INTO PUBLIC."GENRE" (genre_id, name) values ( 5, 'DOCUMENTARY');
insert INTO PUBLIC."GENRE" (genre_id, name) values ( 6, 'ACTION');

insert INTO PUBLIC."FILM_GENRE" (film_id, genre_id) values ( 1, 2);
insert INTO PUBLIC."FILM_GENRE" (film_id, genre_id) values ( 1, 6);
insert INTO PUBLIC."FILM_GENRE" (film_id, genre_id) values ( 2, 1);
insert INTO PUBLIC."FILM_GENRE" (film_id, genre_id) values ( 3, 3);
insert INTO PUBLIC."FILM_GENRE" (film_id, genre_id) values ( 3, 5);
insert INTO PUBLIC."FILM_GENRE" (film_id, genre_id) values ( 4, 2);
insert INTO PUBLIC."FILM_GENRE" (film_id, genre_id) values ( 5, 4);
insert INTO PUBLIC."FILM_GENRE" (film_id, genre_id) values ( 5, 2);

insert INTO PUBLIC."USER_LIKE" (user_id, film_id) values ( 1, 2);
insert INTO PUBLIC."USER_LIKE" (user_id, film_id) values ( 1, 4);
insert INTO PUBLIC."USER_LIKE" (user_id, film_id) values ( 3, 2);
insert INTO PUBLIC."USER_LIKE" (user_id, film_id) values ( 4, 5);
insert INTO PUBLIC."USER_LIKE" (user_id, film_id) values ( 5, 1);
insert INTO PUBLIC."USER_LIKE" (user_id, film_id) values ( 5, 2);

insert INTO PUBLIC."USER_FRIEND" (user_id, user_friend_id) values ( 1, 2);
insert INTO PUBLIC."USER_FRIEND" (user_id, user_friend_id) values ( 2, 1);
insert INTO PUBLIC."USER_FRIEND" (user_id, user_friend_id) values ( 1, 3);
insert INTO PUBLIC."USER_FRIEND" (user_id, user_friend_id) values ( 3, 1);
insert INTO PUBLIC."USER_FRIEND" (user_id, user_friend_id) values ( 2, 4);
insert INTO PUBLIC."USER_FRIEND" (user_id, user_friend_id) values ( 2, 5);
insert INTO PUBLIC."USER_FRIEND" (user_id, user_friend_id) values ( 1, 4);
insert INTO PUBLIC."USER_FRIEND" (user_id, user_friend_id) values ( 4, 3);